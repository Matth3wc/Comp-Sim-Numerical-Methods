"""
Magnetisation and Susceptibility Experiment Data
"""
import numpy as np
from dataclasses import dataclass


@dataclass
class Run:
    """Single experimental run."""
    current: np.ndarray
    values: np.ndarray
    
    def __post_init__(self):
        self.current = np.array(self.current, dtype=float)
        self.values = np.array(self.values, dtype=float)


class Data:
    """All experimental data."""
    
    # Constants
    g = 9.81
    chi_mohrs = 0.33  # Mass susceptibility χ_m = 0.33 J·T⁻²·kg⁻¹ (lab manual value)
    mohrs_mass = 73.9e-6    # 73.9 mg in kg
    ggg_mass = 24.4e-6      # 24.4 mg in kg
    haematite_mass = 22.2e-6  # 22.2 mg in kg
    
    def __init__(self):
        # Experiment 1A: B vs I calibration (field in Tesla)
        self.exp1a_for = Run(
            current=[0, 1.02, 2.05, 3.06, 4.06, 5.01, 6.02, 7.04, 8.06, 9.05, 10.05, 11.05, 11.54, 11.01, 10.02, 8.93, 8.02, 6.99, 6.05, 4.99, 4.01, 3.02, 2, 1, 0],
            values=[0.017, 0.149, 0.295, 0.433, 0.557, 0.664, 0.761, 0.839, 0.901, 0.949, 0.99, 1.024, 1.038, 1.024, 0.993, 0.949, 0.906, 0.847, 0.783, 0.688, 0.578, 0.453, 0.311, 0.163, 0.017]
        )
        self.exp1a_rev = Run(
            current=[1.04, 2.01, 3.03, 4.01, 5.07, 6.03, 7.07, 8.05, 9.02, 10.01, 11, 11.51, 10.98, 9.98, 9.05, 8.02, 7.02, 6.03, 4.91, 4.01, 3.02, 1.98, 0.91, 0],
            values=[-0.134, -0.271, -0.413, -0.542, -0.667, -0.763, -0.841, -0.902, -0.951, -0.992, -1.024, -1.04, -1.024, -0.993, -0.956, -0.908, -0.852, -0.784, -0.682, -0.582, -0.456, -0.31, -0.153, -0.018]
        )
        
        # Experiment 1B: Field gradient baseline (no sample, weight in mg)
        self.exp1b_base_for = Run(
            current=[0, 1.03, 2.02, 3.1, 4.04, 5.03, 6.05, 7.01, 8.06, 9.1, 10.02, 11.05, 11.52, 10.91, 10.06, 9.04, 8.05, 7.02, 6.02, 5.05, 3.98, 2.98, 2.04, 1.06, 0],
            values=[0, -0.5, -0.1, 0.3, 0.8, 0.3, -0.2, -0.7, -1.5, -2, -2.6, -2.9, -3.1, -2.6, -1.9, -1.3, -0.4, 1.1, 2.4, 3.7, 4.6, 3.6, 2.3, 0.8, -0.6]
        )
        self.exp1b_base_rev = Run(
            current=[0, 1.01, 2.01, 3.01, 4.02, 5.03, 6.01, 7.01, 8.01, 9.02, 9.945, 11.01, 11.82, 10.97, 9.98, 8.99, 8.04, 6.98, 6, 4.96, 4.05, 3.08, 2.06, 1, 0],
            values=[-0.2, -0.2, -0.5, -0.1, 0.2, -0.2, -0.4, -1.1, -1.9, -1.7, -2.9, -3.4, -3.7, -3.4, -2.6, -2.1, -0.09, 1, 2.2, 3.5, 4.1, 3.7, 1.5, 0.3, -0.5]
        )
        
        # Experiment 1B: Mohr's salt calibration (73.9mg, weight in mg)
        self.exp1b_mohrs_for = Run(
            current=[0, 1.04, 2, 3.01, 4.05, 5, 6.01, 7.05, 8.04, 9.03, 10.01, 11.03, 11.52, 10.96, 10.05, 9.03, 8.04, 7, 6.03, 4.99, 4.04, 3.03, 2.02, 0.99, 0],
            values=[0.5, 0.5, 1.7, 3.9, 6.8, 9, 11, 12.6, 13.4, 14.9, 15, 16.2, 16.7, 16.4, 16.1, 15.7, 15.5, 14.9, 13.9, 13, 11.5, 8.2, 5.2, 1.9, 0.3]
        )
        self.exp1b_mohrs_rev = Run(
            current=[0, 1.01, 1.97, 3.02, 4.02, 5.01, 5.96, 6.95, 8.03, 9.02, 10.05, 10.99, 11.6, 10.92, 10.03, 9.06, 7.99, 7.03, 6.07, 5.02, 3.99, 3.08, 2.04, 1.05, 0],
            values=[0, 0, 1, 2.8, 5.7, 8, 9.9, 11.5, 13.1, 14.2, 14.7, 15.4, 16.1, 15.7, 15.3, 14.7, 14.4, 14.4, 14.3, 12.8, 10.7, 8, 4.3, 1.9, 0]
        )
        
        # Experiment 2: Paramagnetic GGG (24.4mg, weight in mg)
        self.exp2_for = Run(
            current=[0, 1.01, 1.99, 2.99, 3.97, 5.04, 6.02, 7.02, 8.07, 9.05, 9.99, 9.03, 8.05, 7.03, 6.04, 5.05, 4.01, 3.05, 2.02, 0.93, 0],
            values=[0, 0.1, 1.3, 3.4, 5.3, 6.2, 6.9, 7.9, 9.6, 30, 42.7, 31.3, 18.1, 11.5, 11.8, 11.2, 10, 7.8, 5, 2.3, 0.9]
        )
        self.exp2_rev = Run(
            current=[0, 1, 2.01, 3.04, 4, 5, 6.08, 6.98, 7.99, 9.01, 10.09, 9.04, 8.01, 7.02, 6, 5.03, 4, 3.04, 2.04, 0.99, 0],
            values=[0, 0.8, 1.9, 3.6, 5.2, 6.7, 8.2, 8.6, 10.4, 30.1, 43.2, 32.2, 15.2, 10, 9.8, 9.1, 8.7, 6.3, 3.9, 1, -0.9]
        )
        
        # Experiment 3: Ferromagnetic Haematite (22.2mg, weight in mg)
        self.exp3_for = Run(
            current=[0, 1.02, 2.01, 2.99, 4.03, 5, 6.02, 6.98, 8.02, 9.02, 9.99, 10.69, 9.94, 8.75, 7.95, 7.02, 6.01, 4.96, 4.02, 3, 2.04, 1.08, 0],
            values=[0.6, 0.4, 2.3, 5.1, 7.9, 10.5, 13.1, 14.5, 15.4, 16.1, 16.4, 17, 16.8, 16.7, 17, 16.8, 16.3, 16, 13.7, 10.6, 5.9, 2.5, -0.6]
        )
        self.exp3_rev = Run(
            current=[0, 0.99, 2, 3.03, 4.06, 5.04, 5.96, 6.99, 7.95, 9.03, 10.01, 10.57, 9.93, 9.02, 8.08, 7.01, 6.05, 5.06, 4.02, 2.91, 1.95, 0.82, 0],
            values=[0, 0, 1.9, 4.2, 6.9, 8.9, 10.6, 11.4, 12.3, 12.7, 13, 12.5, 13, 13, 12.7, 12.6, 12.2, 11.6, 9.5, 6.1, 3, -0.8, -3.1]
        )
